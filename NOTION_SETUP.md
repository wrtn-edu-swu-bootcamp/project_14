# 📚 Notion 연동 설정 가이드 (5분 완료!)

폴리 AI에서 **"이 정책 노션에 저장해줘"** 라고 말하면 자동으로 Notion에 저장됩니다! 🎉

---

## 🎯 4단계로 끝내기

### 1단계: Notion 통합(Integration) 만들기 (2분)

1. **https://www.notion.so/my-integrations** 접속
2. **"+ New integration"** 클릭
3. **이름 입력:** "폴리 AI" (아무거나 가능)
4. **Associated workspace** 선택
5. **"Submit"** 클릭
6. **"Internal Integration Secret"** 복사
   - `ntn_` 또는 `secret_`로 시작하는 긴 문자열

---

### 2단계: Notion 데이터베이스 만들기 (2분)

**Notion에서 새 데이터베이스 생성:**

1. **Notion에서 새 페이지 생성**
   - 좌측 사이드바에서 `+ New page` 클릭

2. **데이터베이스 생성**
   - `/database` 입력 → `Table - Full page` 선택
   - 제목: `청년정책북마크` (원하는 이름으로!)

3. **속성(컬럼) 추가하기**
   
   **기본 속성 (Name → 정책명으로 변경):**
   - 첫 번째 컬럼 클릭 → "Edit property" → 이름을 `정책명`으로 변경
   
   **추가 속성 (우측 `+` 버튼 클릭):**
   
   | 속성 이름 | 타입 | 설명 |
   |---------|------|------|
   | 카테고리 | Select | 주거, 일자리, 창업, 교육, 자산형성, 복지, 문화, 기타 |
   | 지역 | Select | 전국, 서울, 경기, 부산, 인천, 대전, 광주 등 |
   | 지원내용 | Text | 정책 지원 내용 |
   | 신청요건 | Text | 신청 자격 조건 |
   | 신청기간 | Text | 신청 기간 |
   | 신청링크 | URL | 신청 사이트 주소 |
   | 운영기관 | Text | 담당 기관 |
   | 대상연령 | Text | 연령 조건 |
   | 저장일 | Date | 저장한 날짜 |
   | 상태 | Select | 관심있음, 신청예정, 신청완료, 승인완료 |

**💡 팁:** 모든 속성을 추가하지 않아도 기본 기능은 작동해요!

---

### 3단계: 통합 연결 + 데이터베이스 ID 복사 (1분)

1. **데이터베이스 페이지 열기**
2. **우측 상단 `⋯` (더보기) 클릭**
3. **"Connections" 또는 "연결" 클릭**
4. **1단계에서 만든 "폴리 AI" 선택 → "Confirm"**

5. **데이터베이스 ID 복사하기:**
   - 데이터베이스 URL을 보세요:
   ```
   https://www.notion.so/myworkspace/abc123def456...?v=...
                                    ^^^^^^^^^^^^^^^^
                                    이 부분이 Database ID!
   ```
   - `?v=` 앞까지의 32자리 문자열을 복사하세요

---

### 4단계: 환경변수 설정 (1분)

프로젝트 폴더의 `.env.local` 파일에 추가:

```bash
# Notion API 키 (1단계에서 복사한 키)
NOTION_API_KEY=ntn_여기에_복사한_키_붙여넣기

# Notion 데이터베이스 ID (3단계에서 복사한 ID)
NOTION_DATABASE_ID=abc123def456여기에_복사한_ID_붙여넣기
```

**서버 재시작:** `Ctrl+C` → `npm run dev`

---

## ✅ 완료! 사용 방법

이제 폴리 AI에서 자연스럽게 대화하세요:

```
👤 "서울에서 받을 수 있는 월세 지원 정책 알려줘"
🤖 "📋 청년 월세 지원 사업이 있어! ... (정책 설명)"

👤 "이거 노션에 저장해줘"
🤖 "✅ Notion에 저장했어! 
    📚 저장된 정책: 청년 월세 지원 사업
    🔗 노션에서 보기: https://notion.so/..."
```

**다양한 저장 요청 방식:**
- "이 정책 노션에 저장해줘"
- "청년 월세 지원 사업 북마크해줘"
- "저장해줘"
- "노션에 추가해줘"

---

## ❓ 문제 해결

### "데이터베이스를 찾을 수 없습니다"

1. **NOTION_DATABASE_ID**가 올바른지 확인
2. **3단계(통합 연결)**을 다시 확인
3. 데이터베이스 URL에서 ID를 정확히 복사했는지 확인

### "API 키가 유효하지 않습니다"

→ `.env.local` 파일의 `NOTION_API_KEY`를 다시 확인하세요!

### "Notion 설정이 필요합니다" 라고 나와요

→ `.env.local`에 **두 가지** 환경변수가 모두 있는지 확인:
- `NOTION_API_KEY`
- `NOTION_DATABASE_ID`

### 저장이 안 돼요

1. 서버 재시작: `Ctrl+C` → `npm run dev`
2. 브라우저 새로고침
3. 서버 콘솔에서 에러 메시지 확인

---

## 💡 팁

- **정책 이름을 정확하게** 말하면 더 잘 저장돼요!
- 한 번 설정하면 **영구적으로** 사용 가능해요!
- 저장된 정책은 Notion에서 **상태 관리**할 수 있어요! (관심있음 → 신청완료)
- Notion 앱에서 알림을 켜면 저장 알림을 받을 수 있어요!

---

**설정 완료!** 🎉 이제 폴리 AI에게 정책을 물어보고, 마음에 드는 건 "노션에 저장해줘"라고 말해보세요! 🚀
